/*! FlareMediaPlayer Version:0.0.0 Built On: 2016-03-24 */
(function(){var a=this,b=b||{VERSION:"0.0.0",PLAYERS:[]};return b.CONSTANTS={NETWORK:{REQUEST:{CONNECT:100},RESPONSE:{}}},b.AudioEngine=function(a){return this.mediaPlayer=a,this},b.AudioEngine.prototype={},b.AudioEngine.prototype.constructor=b.AudioEngine,b.Buffer=function(a){return this.mediaPlayer=a,this},b.Buffer.prototype={},b.Buffer.prototype.constructor=b.Buffer,b.Canvas=function(a){return this.mediaPlayer=a,this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.canvas.id=a.id,this.canvas.width=960,this.canvas.height=540,this.canvas.style.display="block",this.canvas.style.backgroundColor="black",this},b.Canvas.prototype={addToDOM:function(){var a,b=this.mediaPlayer.parent;b&&("string"==typeof b?a=document.getElementById(b):"object"==typeof b&&1===b.nodeType&&(a=b)),a||(a=document.body),a.appendChild(this.canvas)},render:function(a){this.ctx.drawImage(a,0,0)}},b.Canvas.prototype.constructor=b.Canvas,b.MediaPlayer=function(a){return this.id=b.PLAYERS.push(this)-1,this.parent="parent",this.url=null,this.frameWidth=null,this.frameHeight=null,this._networkManager=null,this._forceUpdate,this.isBooted=null,this.oscillator=null,this.testCounter=0,this.device=b.Device,this.device.whenReady(this.boot,this),console.log("Flare Media Player BETA  www.flaremediaplayer.com"),this},b.MediaPlayer.prototype={boot:function(){if(!this.isBooted){this._forceUpdate=!0,this.oscillator=new b.Oscillator(this),this.clock=new b.Clock(this),this._networkManager=new b.NetworkManager(this),this.canvas=new b.Canvas(this),this.canvas.addToDOM(),this.frames=[152];for(var a,c=0;152>c;c++)this.frames[c]=new Image(960,540),a=10>c?"00"+c:100>c?"0"+c:c,this.frames[c].src="./testVideo/frame"+a+".jpg";this.clock.boot(),this.oscillator.run()}},update:function(a){this.clock.update(a),this.canvas.render(this.frames[this.testCounter%152]),this.testCounter++}},b.MediaPlayer.prototype.constructor=b.MediaPlayer,b.VideoEngine=function(a){return this.mediaPlayer=a,this},b.VideoEngine.prototype={},b.VideoEngine.prototype.constructor=b.VideoEngine,b.NetworkManager=function(a){return this.mediaPlayer=a,this.socket,this.connected=!1,this.callbacks={},this.connect(),this.setup(),this},b.NetworkManager.prototype={connect:function(){this.socket=new WebSocket("ws://localhost:6661")},close:function(){this.socket.close()},setup:function(){this.socket.onopen=this.onOpen.bind(this),this.socket.onclose=this.onClose.bind(this),this.socket.onmessage=this.onMessage.bind(this),this.socket.onerror=this.onError.bind(this)},onOpen:function(){console.log("connection Opened"),this.socket.send("hello")},onClose:function(){console.log("closed")},onMessage:function(a){console.log(a.data)},onError:function(a){console.log(a)},send:function(a){this.socket.send(a)}},b.NetworkManager.prototype.constructor=b.NetworkManager,b.NETWORK_PROTOCOL_TABLE={},b.NETWORK_PROTOCOL_TABLE[b.CONSTANTS.NETWORK.REQUEST.CONNECT]="Connect","undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=b),exports.Flare=b):"undefined"!=typeof define&&define.amd?define("Flare",function(){return a.Flare=b}()):a.Flare=b,b}).call(this),Flare.Clock=function(a){return this.mediaPlayer=a,this._timeInitialized=0,this.elapsed=0,this.elapsedMs=0,this.previousTime=0,this.currentTime=0,this.timeUpdated=0,this.lastTimeUpdated=0,this},Flare.Clock.prototype={boot:function(){this._timeInitialized=Date.now(),this.timeUpdated=Date.now()},refresh:function(){this.lastTimeUpdated=this.timeUpdated,this.timeUpdated=Date.now(),this.elapsedMs=this.timeUpdated-this.lastTimeUpdated},update:function(a){this.lastTimeUpdated=this.timeUpdated,this.timeUpdated=Date.now(),this.elapsedMS=this.timeUpdated-this.lastTimeUpdated,this.previousTime=this.currentTime,this.currentTime=a,this.elapsed=this.currentTime-this.previousTime}},Flare.Clock.prototype.constructor=Flare.Clock,Flare.Oscillator=function(a){return this.mediaPlayer=a,this.running=!1,this._loopFunction=null,this._eventId=null,this.fps=30,this.updateSpeed=0,this.usingSetTimeOut=!1,this.usingRequestAnimationFrame=!1,this},Flare.Oscillator.prototype={run:function(){this.running=!0;var a=this;this.updateSpeed=Math.floor(1e3/this.fps),window.requestAnimationFrame?(this.usingRequestAnimationFrame=!0,this._loopFunction=function(b){return a.updateRequestAnimationFrame(b)},this._eventId=window.requestAnimationFrame(this._loopFunction)):(this.usingSetTimeOut=!0,this._loopFunction=function(){return a.updateSetTimeout()},this._eventId=window.setTimeout(this._loopFunction,0))},stop:function(){this.usingSetTimeOut?clearTimeout(this._eventId):window.cancelAnimationFrame(this._eventId),this.running=!1},updateRequestAnimationFrame:function(a){this.mediaPlayer.update(Math.floor(a)),this._eventId=window.requestAnimationFrame(this._loopFunction)},updateSetTimeout:function(){this.mediaPlayer.update(Date.now()),this._eventId=window.setTimeout(this._loopFunction,this.updateSpeed)}},Flare.Oscillator.prototype.constructor=Flare.Oscillator,Flare.Device=function(){this.deviceReadyAt=0,this.initialized=!1,this.isDesktop=!1,this.isIOS=!1,this.iOSVersion=0,this.isAndroid=!1,this.isChromeOS=!1,this.isLinux=!1,this.isOSX=!1,this.isWindows=!1,this.isWindowsPhone=!1,this.hasCanvas=!1,this.hasWebGL=!1,this.hasFile=!1,this.hasFileSystem=!1,this.hasLocalStorage=!1,this.hasCss3D=!1,this.hasPointerLock=!1,this.hasTypedArray=!1,this.hasVibration=!1,this.hasTouch=!1,this.hasMousePointer=!1,this.hasWheelEvent=null,this.isChrome=!1,this.chromeVersion=0,this.isEpiphany=!1,this.isFirefox=!1,this.firefoxVersion=0,this.isIe=!1,this.ieVersion=0,this.isTrident=!1,this.tridentVersion=0,this.isEdge=!1,this.isMobileIOS=!1,this.isMidori=!1,this.isOpera=!1,this.isSafari=!1,this.safariVersion=0,this.isWebApp=!1,this.isSilk=!1,this.hasAudioData=!1,this.hasWebAudio=!1,this.isIPhone=!1,this.isIPad=!1,this.pixelRatio=0,this.littleEndian=!1,this.LITTLE_ENDIAN=!1,this.supports32bit=!1,this.fullscreen=!1},Flare.Device=new Flare.Device,Flare.Device._initialize=function(){},Flare.Device.whenReady=function(a,b){var c=this._readyCheck;this.deviceReadyAt||!c?a.call(b,this):c._monitor?(c._queue=c._queue||[],c._queue.push([a,b])):(c._monitor=c.bind(this),c._queue=c._queue||[],c._queue.push([a,b]),"complete"===document.readyState||"interactive"===document.readyState?window.setTimeout(c._monitor,0):(document.addEventListener("DOMContentLoaded",c._monitor,!1),window.addEventListener("load",c._monitor,!1)))},Flare.Device._readyCheck=function(){var a=this._readyCheck;if(document.body){if(!this.deviceReadyAt){this.deviceReadyAt=Date.now(),document.removeEventListener("deviceready",a._monitor),document.removeEventListener("DOMContentLoaded",a._monitor),window.removeEventListener("load",a._monitor),this._initialize(),this.initialized=!0;for(var b;b=a._queue.shift();){var c=b[0],d=b[1];c.call(d,this)}this._readyCheck=null,this._initialize=null,this.onInitialized=null}}else window.setTimeout(a._monitor,20)},Flare.EventDispatcher=function(){},Flare.EventDispatcher.prototype={},Flare.EventDispatcher.prototype.constructor=Flare.EventDispatcher;